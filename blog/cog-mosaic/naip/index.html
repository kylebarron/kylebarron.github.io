<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.12.4"/><meta name="description" content="Serving aerial imagery map tiles on the fly with AWS Lambda and Cloud-Optimized GeoTIFF" data-gatsby-head="true"/><meta name="image" content="https://kylebarron.dev/static/da6e407cc9e40feacc0aafa2ddab473d/a6c62/grca.jpg" data-gatsby-head="true"/><meta property="og:title" content="Serverless High-Resolution Aerial Imagery for the U.S. | Kyle Barron" data-gatsby-head="true"/><meta property="og:url" content="https://kylebarron.dev/blog/cog-mosaic/naip" data-gatsby-head="true"/><meta property="og:description" content="Serving aerial imagery map tiles on the fly with AWS Lambda and Cloud-Optimized GeoTIFF" data-gatsby-head="true"/><meta property="og:image" content="https://kylebarron.dev/static/da6e407cc9e40feacc0aafa2ddab473d/a6c62/grca.jpg" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:image:alt" content="Serving aerial imagery map tiles on the fly with AWS Lambda and Cloud-Optimized GeoTIFF" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta name="twitter:title" content="Serverless High-Resolution Aerial Imagery for the U.S. | Kyle Barron" data-gatsby-head="true"/><meta name="twitter:url" content="https://kylebarron.dev/blog/cog-mosaic/naip" data-gatsby-head="true"/><meta name="twitter:description" content="Serving aerial imagery map tiles on the fly with AWS Lambda and Cloud-Optimized GeoTIFF" data-gatsby-head="true"/><meta name="twitter:image" content="https://kylebarron.dev/static/da6e407cc9e40feacc0aafa2ddab473d/a6c62/grca.jpg" data-gatsby-head="true"/><meta name="twitter:image:alt" content="Serving aerial imagery map tiles on the fly with AWS Lambda and Cloud-Optimized GeoTIFF" data-gatsby-head="true"/><meta name="twitter:creator" content="@kylebarron2" data-gatsby-head="true"/><meta name="gatsby-theme" content="@lekoarts/gatsby-theme-minimal-blog" data-gatsby-head="true"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link rel="alternate" type="application/rss+xml" title="Kyle Barron&#x27;s blog" href="/rss.xml"/><style data-emotion="css-global 6koz1s" data-gatsby-head="true">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#edf2f7;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;--theme-ui-colors-highlightLineBg:rgba(0, 0, 0, 0.035);--theme-ui-colors-plain-color:#393A34;--theme-ui-colors-plain-backgroundColor:#f6f8fa;--theme-ui-colors-comment-color:#999988;--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:#999988;--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:#e3116c;--theme-ui-colors-attr-value-color:#e3116c;--theme-ui-colors-punctuation-color:#393A34;--theme-ui-colors-operator-color:#393A34;--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:#36acaa;--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:#36acaa;--theme-ui-colors-constant-color:#36acaa;--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:#36acaa;--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:#00009f;--theme-ui-colors-attr-name-color:#00a4db;--theme-ui-colors-selector-color:#00009f;--theme-ui-colors-function-color:#d73a49;--theme-ui-colors-deleted-color:#d73a49;--theme-ui-colors-tag-color:#00009f;--theme-ui-colors-function-variable-color:#6f42c1;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-light,.theme-ui-light html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#edf2f7;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;--theme-ui-colors-highlightLineBg:rgba(0, 0, 0, 0.035);--theme-ui-colors-plain-color:#393A34;--theme-ui-colors-plain-backgroundColor:#f6f8fa;--theme-ui-colors-comment-color:#999988;--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:#999988;--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:#e3116c;--theme-ui-colors-attr-value-color:#e3116c;--theme-ui-colors-punctuation-color:#393A34;--theme-ui-colors-operator-color:#393A34;--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:#36acaa;--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:#36acaa;--theme-ui-colors-constant-color:#36acaa;--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:#36acaa;--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:#00009f;--theme-ui-colors-attr-name-color:#00a4db;--theme-ui-colors-selector-color:#00009f;--theme-ui-colors-function-color:#d73a49;--theme-ui-colors-deleted-color:#d73a49;--theme-ui-colors-tag-color:#00009f;--theme-ui-colors-function-variable-color:#6f42c1;}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#b794f4;--theme-ui-colors-secondary:#8a9ab0;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;--theme-ui-colors-highlightLineBg:rgba(255, 255, 255, 0.1);--theme-ui-colors-plain-color:#9CDCFE;--theme-ui-colors-plain-backgroundColor:#1E1E1E;--theme-ui-colors-prolog-color:rgb(0, 0, 128);--theme-ui-colors-comment-color:rgb(106, 153, 85);--theme-ui-colors-builtin-color:rgb(86, 156, 214);--theme-ui-colors-changed-color:rgb(86, 156, 214);--theme-ui-colors-keyword-color:rgb(86, 156, 214);--theme-ui-colors-interpolation-punctuation-color:rgb(86, 156, 214);--theme-ui-colors-number-color:rgb(181, 206, 168);--theme-ui-colors-inserted-color:rgb(181, 206, 168);--theme-ui-colors-constant-color:rgb(100, 102, 149);--theme-ui-colors-attr-name-color:rgb(156, 220, 254);--theme-ui-colors-variable-color:rgb(156, 220, 254);--theme-ui-colors-deleted-color:rgb(206, 145, 120);--theme-ui-colors-string-color:rgb(206, 145, 120);--theme-ui-colors-attr-value-color:rgb(206, 145, 120);--theme-ui-colors-template-punctuation-color:rgb(206, 145, 120);--theme-ui-colors-selector-color:rgb(215, 186, 125);--theme-ui-colors-tag-color:rgb(86, 156, 214);--theme-ui-colors-punctuation-color:#808080;--theme-ui-colors-operator-color:rgb(212, 212, 212);--theme-ui-colors-function-color:rgb(220, 220, 170);--theme-ui-colors-class-name-color:rgb(78, 201, 176);--theme-ui-colors-char-color:rgb(209, 105, 105);}</style><style data-emotion="css-global 1mawjxo" data-gatsby-head="true">*{box-sizing:border-box;}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%;}html img{border-style:none;}html pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;}html a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:var(--theme-ui-colors-text);}body{margin:0;}</style><title data-gatsby-head="true">Serverless High-Resolution Aerial Imagery for the U.S. | Kyle Barron</title><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" data-gatsby-head="true"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" data-gatsby-head="true"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" data-gatsby-head="true"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global 6koz1s">html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#edf2f7;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;--theme-ui-colors-highlightLineBg:rgba(0, 0, 0, 0.035);--theme-ui-colors-plain-color:#393A34;--theme-ui-colors-plain-backgroundColor:#f6f8fa;--theme-ui-colors-comment-color:#999988;--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:#999988;--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:#e3116c;--theme-ui-colors-attr-value-color:#e3116c;--theme-ui-colors-punctuation-color:#393A34;--theme-ui-colors-operator-color:#393A34;--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:#36acaa;--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:#36acaa;--theme-ui-colors-constant-color:#36acaa;--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:#36acaa;--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:#00009f;--theme-ui-colors-attr-name-color:#00a4db;--theme-ui-colors-selector-color:#00009f;--theme-ui-colors-function-color:#d73a49;--theme-ui-colors-deleted-color:#d73a49;--theme-ui-colors-tag-color:#00009f;--theme-ui-colors-function-variable-color:#6f42c1;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}html.theme-ui-light,.theme-ui-light html{--theme-ui-colors-transparent:transparent;--theme-ui-colors-black:#000;--theme-ui-colors-white:#fff;--theme-ui-colors-gray-1:#f7fafc;--theme-ui-colors-gray-2:#edf2f7;--theme-ui-colors-gray-3:#e2e8f0;--theme-ui-colors-gray-4:#cbd5e0;--theme-ui-colors-gray-5:#a0aec0;--theme-ui-colors-gray-6:#718096;--theme-ui-colors-gray-7:#4a5568;--theme-ui-colors-gray-8:#2d3748;--theme-ui-colors-gray-9:#1a202c;--theme-ui-colors-red-1:#fff5f5;--theme-ui-colors-red-2:#fed7d7;--theme-ui-colors-red-3:#feb2b2;--theme-ui-colors-red-4:#fc8181;--theme-ui-colors-red-5:#f56565;--theme-ui-colors-red-6:#e53e3e;--theme-ui-colors-red-7:#c53030;--theme-ui-colors-red-8:#9b2c2c;--theme-ui-colors-red-9:#742a2a;--theme-ui-colors-orange-1:#fffaf0;--theme-ui-colors-orange-2:#feebc8;--theme-ui-colors-orange-3:#fbd38d;--theme-ui-colors-orange-4:#f6ad55;--theme-ui-colors-orange-5:#ed8936;--theme-ui-colors-orange-6:#dd6b20;--theme-ui-colors-orange-7:#c05621;--theme-ui-colors-orange-8:#9c4221;--theme-ui-colors-orange-9:#7b341e;--theme-ui-colors-yellow-1:#fffff0;--theme-ui-colors-yellow-2:#fefcbf;--theme-ui-colors-yellow-3:#faf089;--theme-ui-colors-yellow-4:#f6e05e;--theme-ui-colors-yellow-5:#ecc94b;--theme-ui-colors-yellow-6:#d69e2e;--theme-ui-colors-yellow-7:#b7791f;--theme-ui-colors-yellow-8:#975a16;--theme-ui-colors-yellow-9:#744210;--theme-ui-colors-green-1:#f0fff4;--theme-ui-colors-green-2:#c6f6d5;--theme-ui-colors-green-3:#9ae6b4;--theme-ui-colors-green-4:#68d391;--theme-ui-colors-green-5:#48bb78;--theme-ui-colors-green-6:#38a169;--theme-ui-colors-green-7:#2f855a;--theme-ui-colors-green-8:#276749;--theme-ui-colors-green-9:#22543d;--theme-ui-colors-teal-1:#e6fffa;--theme-ui-colors-teal-2:#b2f5ea;--theme-ui-colors-teal-3:#81e6d9;--theme-ui-colors-teal-4:#4fd1c5;--theme-ui-colors-teal-5:#38b2ac;--theme-ui-colors-teal-6:#319795;--theme-ui-colors-teal-7:#2c7a7b;--theme-ui-colors-teal-8:#285e61;--theme-ui-colors-teal-9:#234e52;--theme-ui-colors-blue-1:#ebf8ff;--theme-ui-colors-blue-2:#bee3f8;--theme-ui-colors-blue-3:#90cdf4;--theme-ui-colors-blue-4:#63b3ed;--theme-ui-colors-blue-5:#4299e1;--theme-ui-colors-blue-6:#3182ce;--theme-ui-colors-blue-7:#2b6cb0;--theme-ui-colors-blue-8:#2c5282;--theme-ui-colors-blue-9:#2a4365;--theme-ui-colors-indigo-1:#ebf4ff;--theme-ui-colors-indigo-2:#c3dafe;--theme-ui-colors-indigo-3:#a3bffa;--theme-ui-colors-indigo-4:#7f9cf5;--theme-ui-colors-indigo-5:#667eea;--theme-ui-colors-indigo-6:#5a67d8;--theme-ui-colors-indigo-7:#4c51bf;--theme-ui-colors-indigo-8:#434190;--theme-ui-colors-indigo-9:#3c366b;--theme-ui-colors-purple-1:#faf5ff;--theme-ui-colors-purple-2:#e9d8fd;--theme-ui-colors-purple-3:#d6bcfa;--theme-ui-colors-purple-4:#b794f4;--theme-ui-colors-purple-5:#9f7aea;--theme-ui-colors-purple-6:#805ad5;--theme-ui-colors-purple-7:#6b46c1;--theme-ui-colors-purple-8:#553c9a;--theme-ui-colors-purple-9:#44337a;--theme-ui-colors-pink-1:#fff5f7;--theme-ui-colors-pink-2:#fed7e2;--theme-ui-colors-pink-3:#fbb6ce;--theme-ui-colors-pink-4:#f687b3;--theme-ui-colors-pink-5:#ed64a6;--theme-ui-colors-pink-6:#d53f8c;--theme-ui-colors-pink-7:#b83280;--theme-ui-colors-pink-8:#97266d;--theme-ui-colors-pink-9:#702459;--theme-ui-colors-grayDark:#2d3748;--theme-ui-colors-text:#2d3748;--theme-ui-colors-background:#fff;--theme-ui-colors-primary:#6b46c1;--theme-ui-colors-primaryHover:#2c5282;--theme-ui-colors-secondary:#5f6c80;--theme-ui-colors-muted:#edf2f7;--theme-ui-colors-success:#9ae6b4;--theme-ui-colors-info:#63b3ed;--theme-ui-colors-warning:#faf089;--theme-ui-colors-danger:#feb2b2;--theme-ui-colors-light:#f7fafc;--theme-ui-colors-dark:#2d3748;--theme-ui-colors-textMuted:#718096;--theme-ui-colors-toggleIcon:#2d3748;--theme-ui-colors-heading:#000;--theme-ui-colors-divide:#cbd5e0;--theme-ui-colors-highlightLineBg:rgba(0, 0, 0, 0.035);--theme-ui-colors-plain-color:#393A34;--theme-ui-colors-plain-backgroundColor:#f6f8fa;--theme-ui-colors-comment-color:#999988;--theme-ui-colors-comment-fontStyle:italic;--theme-ui-colors-prolog-color:#999988;--theme-ui-colors-prolog-fontStyle:italic;--theme-ui-colors-doctype-color:#999988;--theme-ui-colors-doctype-fontStyle:italic;--theme-ui-colors-cdata-color:#999988;--theme-ui-colors-cdata-fontStyle:italic;--theme-ui-colors-namespace-opacity:0.7;--theme-ui-colors-string-color:#e3116c;--theme-ui-colors-attr-value-color:#e3116c;--theme-ui-colors-punctuation-color:#393A34;--theme-ui-colors-operator-color:#393A34;--theme-ui-colors-entity-color:#36acaa;--theme-ui-colors-url-color:#36acaa;--theme-ui-colors-symbol-color:#36acaa;--theme-ui-colors-number-color:#36acaa;--theme-ui-colors-boolean-color:#36acaa;--theme-ui-colors-variable-color:#36acaa;--theme-ui-colors-constant-color:#36acaa;--theme-ui-colors-property-color:#36acaa;--theme-ui-colors-regex-color:#36acaa;--theme-ui-colors-inserted-color:#36acaa;--theme-ui-colors-atrule-color:#00a4db;--theme-ui-colors-keyword-color:#00009f;--theme-ui-colors-attr-name-color:#00a4db;--theme-ui-colors-selector-color:#00009f;--theme-ui-colors-function-color:#d73a49;--theme-ui-colors-deleted-color:#d73a49;--theme-ui-colors-tag-color:#00009f;--theme-ui-colors-function-variable-color:#6f42c1;}html.theme-ui-dark,.theme-ui-dark html{--theme-ui-colors-text:#cbd5e0;--theme-ui-colors-primary:#b794f4;--theme-ui-colors-secondary:#8a9ab0;--theme-ui-colors-toggleIcon:#cbd5e0;--theme-ui-colors-background:#1A202C;--theme-ui-colors-heading:#fff;--theme-ui-colors-divide:#2d3748;--theme-ui-colors-muted:#2d3748;--theme-ui-colors-highlightLineBg:rgba(255, 255, 255, 0.1);--theme-ui-colors-plain-color:#9CDCFE;--theme-ui-colors-plain-backgroundColor:#1E1E1E;--theme-ui-colors-prolog-color:rgb(0, 0, 128);--theme-ui-colors-comment-color:rgb(106, 153, 85);--theme-ui-colors-builtin-color:rgb(86, 156, 214);--theme-ui-colors-changed-color:rgb(86, 156, 214);--theme-ui-colors-keyword-color:rgb(86, 156, 214);--theme-ui-colors-interpolation-punctuation-color:rgb(86, 156, 214);--theme-ui-colors-number-color:rgb(181, 206, 168);--theme-ui-colors-inserted-color:rgb(181, 206, 168);--theme-ui-colors-constant-color:rgb(100, 102, 149);--theme-ui-colors-attr-name-color:rgb(156, 220, 254);--theme-ui-colors-variable-color:rgb(156, 220, 254);--theme-ui-colors-deleted-color:rgb(206, 145, 120);--theme-ui-colors-string-color:rgb(206, 145, 120);--theme-ui-colors-attr-value-color:rgb(206, 145, 120);--theme-ui-colors-template-punctuation-color:rgb(206, 145, 120);--theme-ui-colors-selector-color:rgb(215, 186, 125);--theme-ui-colors-tag-color:rgb(86, 156, 214);--theme-ui-colors-punctuation-color:#808080;--theme-ui-colors-operator-color:rgb(212, 212, 212);--theme-ui-colors-function-color:rgb(220, 220, 170);--theme-ui-colors-class-name-color:rgb(78, 201, 176);--theme-ui-colors-char-color:rgb(209, 105, 105);}</style><style data-emotion="css-global 1mawjxo">*{box-sizing:border-box;}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.625;font-weight:400;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);margin:0;padding:0;box-sizing:border-box;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%;}html img{border-style:none;}html pre{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;}html a{-webkit-transition:all 0.3s ease-in-out;transition:all 0.3s ease-in-out;color:var(--theme-ui-colors-text);}body{margin:0;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css-global cjr7z1">*{box-sizing:inherit;}[hidden]{display:none;}::selection{background-color:var(--theme-ui-colors-text);color:var(--theme-ui-colors-background);}</style><style data-emotion="css 1gq7j3t">.css-1gq7j3t{border:0;clip:react(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;overflow:hidden;position:absolute;}.css-1gq7j3t:focus{padding:1rem;position:fixed;top:15px;left:15px;background-color:var(--theme-ui-colors-heading);color:var(--theme-ui-colors-background);z-index:1;width:auto;height:auto;clip:auto;-webkit-text-decoration:none;text-decoration:none;}</style><a href="#skip-nav" data-skip-link="true" class="css-1gq7j3t">Skip to content</a><style data-emotion="css 10f80pj">.css-10f80pj{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding:1rem;max-width:1024px;}@media screen and (min-width: 640px){.css-10f80pj{padding:2rem;}}</style><div class="css-10f80pj"><style data-emotion="css egutgn">.css-egutgn{margin-bottom:4rem;}@media screen and (min-width: 640px){.css-egutgn{margin-bottom:8rem;}}</style><header class="css-egutgn"><style data-emotion="css 1xwyizx">.css-1xwyizx{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><style data-emotion="css 1pbimyf">.css-1pbimyf{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}</style><div class="css-1pbimyf"><style data-emotion="css uxjqfw">.css-uxjqfw{color:var(--theme-ui-colors-heading);-webkit-text-decoration:none;text-decoration:none;}</style><a aria-label="Kyle Barron - Back to home" class="css-uxjqfw" href="/"><style data-emotion="css 19i8ga6">.css-19i8ga6{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.5rem;}@media screen and (min-width: 640px){.css-19i8ga6{font-size:1.875rem;}}</style><div class="css-19i8ga6">Kyle Barron</div></a><style data-emotion="css 3ba0x7">.css-3ba0x7{opacity:0.65;position:relative;border-radius:4px;width:40px;height:25px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease;border:none;outline:none;background:none;cursor:pointer;padding:0;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;}.css-3ba0x7:hover,.css-3ba0x7:focus{opacity:1;}</style><button type="button" class="css-3ba0x7"><style data-emotion="css 1ggalm8">.css-1ggalm8{position:relative;width:24px;height:24px;border-radius:50%;-webkit-transition:all 0.45s ease;transition:all 0.45s ease;-webkit-transform:scale(0.55);-moz-transform:scale(0.55);-ms-transform:scale(0.55);transform:scale(0.55);}.css-1ggalm8:before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;-webkit-transition:-webkit-transform 0.45s ease;transition:transform 0.45s ease;border-radius:50%;opacity:0;}.css-1ggalm8:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;-webkit-transition:all 0.35s ease;transition:all 0.35s ease;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon),0 23px 0 var(--theme-ui-colors-toggleIcon),23px 0 0 var(--theme-ui-colors-toggleIcon),-23px 0 0 var(--theme-ui-colors-toggleIcon),15px 15px 0 var(--theme-ui-colors-toggleIcon),-15px 15px 0 var(--theme-ui-colors-toggleIcon),15px -15px 0 var(--theme-ui-colors-toggleIcon),-15px -15px 0 var(--theme-ui-colors-toggleIcon);-webkit-transform:scale(0);-moz-transform:scale(0);-ms-transform:scale(0);transform:scale(0);}</style><div class="css-1ggalm8"></div></button></div><style data-emotion="css fp1v3n">.css-fp1v3n{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:var(--theme-ui-colors-divide);padding-bottom:1rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:1rem;color:var(--theme-ui-colors-secondary);-webkit-box-flex-flow:wrap;-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;}.css-fp1v3n a{color:var(--theme-ui-colors-secondary);}.css-fp1v3n a:hover{color:var(--theme-ui-colors-heading);}</style><div class="css-fp1v3n"><style data-emotion="css 1lx5s1f">.css-1lx5s1f{font-size:1rem;}.css-1lx5s1f a:not(:last-of-type){margin-right:1rem;}@media screen and (min-width: 640px){.css-1lx5s1f{font-size:18px;}}.css-1lx5s1f .active{color:var(--theme-ui-colors-heading);}</style><nav class="css-1lx5s1f"><style data-emotion="css bpdkdn">.css-bpdkdn{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-bpdkdn:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="css-bpdkdn" href="/blog">Blog</a><a class="css-bpdkdn" href="/projects">Projects</a><a class="css-bpdkdn" href="/media">Media</a><a class="css-bpdkdn" href="/about">About</a></nav><style data-emotion="css 45ghvz">.css-45ghvz{font-size:1rem;}.css-45ghvz a:not(:first-of-type){margin-left:1rem;}@media screen and (min-width: 640px){.css-45ghvz{font-size:18px;}}</style><div class="css-45ghvz"><style data-emotion="css aizfxq">.css-aizfxq{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-aizfxq:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://github.com/kylebarron" class="css-aizfxq">GitHub</a><a href="https://twitter.com/kylebarron2" class="css-aizfxq">X</a><a href="https://mapstodon.space/@kylebarron" class="css-aizfxq">Mastodon</a><a href="https://www.linkedin.com/in/kylebarrongeo/" class="css-aizfxq">LinkedIn</a><a href="https://kylebarron.dev/rss.xml" class="css-aizfxq">RSS</a></div></div></header><style data-emotion="css 1jfsjz4">.css-1jfsjz4 [data-name='live-editor']{font-size:1rem;}.css-1jfsjz4 [data-name='live-editor'] textarea,.css-1jfsjz4 [data-name='live-editor'] pre{padding:1rem!important;}.css-1jfsjz4 [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-1jfsjz4 .prism-code{font-size:1rem;padding:1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);overflow:initial;float:left;min-width:100%;margin-bottom:0;}.css-1jfsjz4 .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-1jfsjz4 .token{display:inline-block;}.css-1jfsjz4 p>code,.css-1jfsjz4 li>code{padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-1jfsjz4 .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);overflow:auto;border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1jfsjz4 .gatsby-highlight{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1jfsjz4 .gatsby-highlight{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1jfsjz4 .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-1jfsjz4 .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;}.css-1jfsjz4 .gatsby-highlight pre.language-{margin-top:0;}.css-1jfsjz4 .gatsby-highlight pre.language-noLineNumbers{margin-top:0;}.css-1jfsjz4 .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-1jfsjz4 .gatsby-highlight pre[class~="language-javascript"]:before,.css-1jfsjz4 .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-1jfsjz4 .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1jfsjz4 .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1jfsjz4 .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-1jfsjz4 .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1jfsjz4 .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1jfsjz4 .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-1jfsjz4 .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-1jfsjz4 .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-1jfsjz4 .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-1jfsjz4 .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-1jfsjz4 .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-1jfsjz4 .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-1jfsjz4 .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-1jfsjz4 .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-1jfsjz4 .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-1jfsjz4 .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-1jfsjz4 .gatsby-highlight pre[class~='language-json']:before,.css-1jfsjz4 .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-1jfsjz4 .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-1jfsjz4 .gatsby-highlight>code[class*="language-"],.css-1jfsjz4 .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-1jfsjz4 .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-1jfsjz4 .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1jfsjz4 .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1jfsjz4 .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1jfsjz4 .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-1jfsjz4 [data-name='live-preview'],.css-1jfsjz4 [data-name='live-editor']{margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-1jfsjz4 [data-name='live-preview'],.css-1jfsjz4 [data-name='live-editor']{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-1jfsjz4 [data-name='live-preview'],.css-1jfsjz4 [data-name='live-editor']{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-1jfsjz4 [data-name='live-preview'],.css-1jfsjz4 [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-1jfsjz4 .token-line{padding-right:1rem;}.css-1jfsjz4 .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-1jfsjz4 .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}</style><style data-emotion="css 18xpaun">.css-18xpaun{box-sizing:border-box;margin:0;min-width:0;}.css-18xpaun [data-name='live-editor']{font-size:1rem;}.css-18xpaun [data-name='live-editor'] textarea,.css-18xpaun [data-name='live-editor'] pre{padding:1rem!important;}.css-18xpaun [data-name='live-preview']{padding:calc(0.5rem + 10px)!important;background-color:#d2c7ec;}.css-18xpaun .prism-code{font-size:1rem;padding:1rem;webkit-overflow-scrolling:touch;background-color:var(--theme-ui-colors-transparent);overflow:initial;float:left;min-width:100%;margin-bottom:0;}.css-18xpaun .prism-code[data-linenumber="false"] .token-line{padding-left:1rem;}.css-18xpaun .token{display:inline-block;}.css-18xpaun p>code,.css-18xpaun li>code{padding-left:0.5rem;padding-right:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:2px;}.css-18xpaun .gatsby-highlight{font-size:1rem;position:relative;webkit-overflow-scrolling:touch;background-color:rgb(1, 22, 39);overflow:auto;border-radius:2px;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-18xpaun .gatsby-highlight{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-18xpaun .gatsby-highlight{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-18xpaun .gatsby-highlight{margin-left:-1rem;margin-right:-1rem;}}.css-18xpaun .gatsby-highlight .token-line{margin-left:-1rem;margin-right:-1rem;}.css-18xpaun .gatsby-highlight pre.language-{margin-top:0;}.css-18xpaun .gatsby-highlight pre.language-noLineNumbers{margin-top:0;}.css-18xpaun .gatsby-highlight pre[class*="language-"]:before{background-color:var(--theme-ui-colors-white);border-radius:0 0 0.25rem 0.25rem;color:var(--theme-ui-colors-black);font-size:12px;letter-spacing:0.025rem;padding:0.1rem 0.5rem;position:absolute;left:1rem;text-align:right;text-transform:uppercase;top:0;}.css-18xpaun .gatsby-highlight pre[class~="language-javascript"]:before,.css-18xpaun .gatsby-highlight pre[class~="language-js"]:before{content:"js";background:#f7df1e;color:var(--theme-ui-colors-black);}.css-18xpaun .gatsby-highlight pre[class~="language-jsx"]:before{content:"jsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-18xpaun .gatsby-highlight pre[class~="language-ts"]:before{content:"ts";background:#61dafb;color:var(--theme-ui-colors-black);}.css-18xpaun .gatsby-highlight pre[class~="language-tsx"]:before{content:"tsx";background:#61dafb;color:var(--theme-ui-colors-black);}.css-18xpaun .gatsby-highlight pre[class~="language-html"]:before{content:"html";background:#005a9c;color:var(--theme-ui-colors-white);}.css-18xpaun .gatsby-highlight pre[class~="language-xml"]:before{content:"xml";background:#005a9c;color:var(--theme-ui-colors-white);}.css-18xpaun .gatsby-highlight pre[class~="language-svg"]:before{content:"svg";background:#005a9c;color:var(--theme-ui-colors-white);}.css-18xpaun .gatsby-highlight pre[class~="language-graphql"]:before{content:"GraphQL";background:#E10098;}.css-18xpaun .gatsby-highlight pre[class~="language-css"]:before{content:"css";background:#ff9800;color:var(--theme-ui-colors-black);}.css-18xpaun .gatsby-highlight pre[class~="language-mdx"]:before{content:"mdx";background:#f9ac00;color:var(--theme-ui-colors-black);}.css-18xpaun .gatsby-highlight pre[class~="language-text"]:before{content:"text";}.css-18xpaun .gatsby-highlight pre[class~='language-shell']:before{content:'shell';}.css-18xpaun .gatsby-highlight pre[class~='language-sh']:before{content:'sh';}.css-18xpaun .gatsby-highlight pre[class~='language-bash']:before{content:'bash';}.css-18xpaun .gatsby-highlight pre[class~='language-yaml']:before{content:'yaml';background:#ffa8df;}.css-18xpaun .gatsby-highlight pre[class~='language-yml']:before{content:'yml';background:#ffa8df;}.css-18xpaun .gatsby-highlight pre[class~='language-markdown']:before{content:'md';}.css-18xpaun .gatsby-highlight pre[class~='language-json']:before,.css-18xpaun .gatsby-highlight pre[class~='language-json5']:before{content:'json';background:linen;}.css-18xpaun .gatsby-highlight pre[class~='language-diff']:before{content:'diff';background:#e6ffed;}.css-18xpaun .gatsby-highlight>code[class*="language-"],.css-18xpaun .gatsby-highlight>pre[class=*="language-"]{word-spacing:normal;word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-18xpaun .line-number-style{display:inline-block;width:3em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.3;text-align:center;position:relative;}.css-18xpaun .code-title{background-color:#d2c7ec;color:var(--theme-ui-colors-black);font-size:0.875rem;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-18xpaun .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-18xpaun .code-title{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-18xpaun .code-title{margin-left:-1rem;margin-right:-1rem;}}.css-18xpaun [data-name='live-preview'],.css-18xpaun [data-name='live-editor']{margin-left:0;margin-right:0;}@media screen and (min-width: 640px){.css-18xpaun [data-name='live-preview'],.css-18xpaun [data-name='live-editor']{margin-left:0;margin-right:0;}}@media screen and (min-width: 768px){.css-18xpaun [data-name='live-preview'],.css-18xpaun [data-name='live-editor']{margin-left:0;margin-right:0;}}@media screen and (min-width: 1024px){.css-18xpaun [data-name='live-preview'],.css-18xpaun [data-name='live-editor']{margin-left:-1rem;margin-right:-1rem;}}.css-18xpaun .token-line{padding-right:1rem;}.css-18xpaun .highlight-line{background-color:rgb(2, 55, 81);border-left:4px solid rgb(2, 155, 206);}.css-18xpaun .highlight-line .line-number-style{width:calc(3em - 4px);opacity:0.5;left:-2px;}</style><main id="skip-nav" class=" css-18xpaun"><style data-emotion="css w1q1hj">.css-w1q1hj{box-sizing:border-box;margin:0;min-width:0;font-family:inherit;font-weight:700;line-height:1.25;font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.875rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-w1q1hj{font-size:2.25rem;}}@media screen and (min-width: 768px){.css-w1q1hj{font-size:2.25rem;}}@media screen and (min-width: 1024px){.css-w1q1hj{font-size:3rem;}}</style><h1 class="css-w1q1hj">Serverless High-Resolution Aerial Imagery for the U.S.</h1><style data-emotion="css 15ce8we">.css-15ce8we{color:var(--theme-ui-colors-secondary);margin-top:1rem;font-size:1rem;}.css-15ce8we a{color:var(--theme-ui-colors-secondary);}@media screen and (min-width: 640px){.css-15ce8we{font-size:1rem;}}@media screen and (min-width: 768px){.css-15ce8we{font-size:1.25rem;}}</style><p class="css-15ce8we"><time>September 2nd, 2020</time> — <a class="css-bpdkdn" href="/tags/cloud-optimized-geo-tiff">Cloud-Optimized GeoTIFF</a>, <a class="css-bpdkdn" href="/tags/serverless">Serverless</a>, <a class="css-bpdkdn" href="/tags/map-tiles">Map tiles</a> — <span>11<!-- --> min read</span></p><style data-emotion="css 1mae7sn">.css-1mae7sn{margin-top:4rem;margin-bottom:4rem;}.css-1mae7sn .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;border-radius:4px;box-shadow:rgba(0, 0, 0, 0.1) 0px 16px 16px 0px,rgba(0, 0, 0, 0.1) 0px 8px 8px 0px,rgba(0, 0, 0, 0.1) 0px 4px 4px 0px;}@media screen and (min-width: 640px){.css-1mae7sn .gatsby-resp-image-wrapper{margin-top:2rem;margin-bottom:2rem;}}@media screen and (min-width: 768px){.css-1mae7sn .gatsby-resp-image-wrapper{margin-top:4rem;margin-bottom:4rem;}}.css-1mae7sn .gatsby-resp-image-wrapper .gatsby-resp-image-image{border-radius:4px;}.css-1mae7sn figure{margin:0;}.css-1mae7sn figure img{border-radius:4px;box-shadow:0 10px 15px -3px rgba(0, 0, 0, 0.1),0 4px 6px -2px rgba(0, 0, 0, 0.05);max-width:100%;}</style><section class="css-1mae7sn"><style data-emotion="css 1d2wwf6">.css-1d2wwf6{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1d2wwf6:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css 1diwg7s">.css-1diwg7s{color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-primary);-webkit-text-decoration:none;text-decoration:none;}.css-1diwg7s:hover{-webkit-text-decoration:underline;text-decoration:underline;}.css-1diwg7s:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="http://kylebarron.github.io/naip-cogeo-mosaic/" class="css-1diwg7s"><span><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 54.58333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQT/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABWPRGL0UT/8QAGhAAAQUBAAAAAAAAAAAAAAAAAAECEBExMv/aAAgBAQABBQJcKHcx/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGxAAAwACAwAAAAAAAAAAAAAAAAERITFBYcH/2gAIAQEAAT8hWZDidlF0No/DhH//2gAMAwEAAgADAAAAEIgP/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/ELWv/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QJ//EABoQAQADAQEBAAAAAAAAAAAAAAEAETEhYZH/2gAIAQEAAT8QQFa89hCMnt2ECrE3rc+KYOGnIqrfUn//2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="60cm-resolution NAIP imagery of the Grand Canyon from 2017"
        title=""
        src="/static/da6e407cc9e40feacc0aafa2ddab473d/18e3b/grca.jpg"
        srcset="/static/da6e407cc9e40feacc0aafa2ddab473d/46946/grca.jpg 240w,
/static/da6e407cc9e40feacc0aafa2ddab473d/55489/grca.jpg 480w,
/static/da6e407cc9e40feacc0aafa2ddab473d/18e3b/grca.jpg 960w,
/static/da6e407cc9e40feacc0aafa2ddab473d/60e21/grca.jpg 1440w,
/static/da6e407cc9e40feacc0aafa2ddab473d/ae03e/grca.jpg 1767w"
        sizes="(max-width: 960px) 100vw, 960px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></span></a>
<style data-emotion="css vehe2z">.css-vehe2z{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-vehe2z{font-size:1rem;}}@media screen and (min-width: 768px){.css-vehe2z{font-size:1.25rem;}}</style><style data-emotion="css z0logh">.css-z0logh{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;word-break:break-word;}@media screen and (min-width: 640px){.css-z0logh{font-size:1rem;}}@media screen and (min-width: 768px){.css-z0logh{font-size:1.25rem;}}@media screen and (min-width: 640px){.css-z0logh{font-size:1rem;}}@media screen and (min-width: 768px){.css-z0logh{font-size:1.25rem;}}</style><p class="css-z0logh">60cm-resolution imagery of the Grand Canyon from 2017. <strong class="css-zezy6m"><a href="http://kylebarron.github.io/naip-cogeo-mosaic/" class="css-1diwg7s">Click for an
interactive example</a></strong>.</p>
<style data-emotion="css 90ntna">.css-90ntna{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-90ntna{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-90ntna{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-90ntna{font-size:2.25rem;}}</style><style data-emotion="css 1h962gv">.css-1h962gv{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.5rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-1h962gv{font-size:2.25rem;}}@media screen and (min-width: 640px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 768px){.css-1h962gv{font-size:1.875rem;}}@media screen and (min-width: 1024px){.css-1h962gv{font-size:2.25rem;}}</style><h2 id="overview" style="position:relative" class="css-1h962gv"><a href="#overview" aria-label="overview permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Overview</h2>
<p class="css-z0logh">More and more public imagery sources are being provided in <a href="https://www.cogeo.org/" class="css-1diwg7s">Cloud-Optimized
GeoTIFF (COG)</a>, an efficient file format for fast random-access reads
of geospatial raster data. This is revolutionary because the format enables new
cloud-native workflows, such as serving imagery to a web map on demand, that
were never before possible.</p>
<p class="css-z0logh">Within half a second, a server can grab and combine the relevant portions of
half a dozen images, reproject into the coordinate reference system used in web
mapping, and return it to the user. Making this process happen on demand can
lead to huge reductions in cost—and zero fixed cost—as terabytes of map data no
longer need to be stored pregenerated and stored.</p>
<p class="css-z0logh">This post builds upon a <a href="https://kylebarron.dev/blog/cog-mosaic/overview" class="css-1diwg7s">previous overview post</a> to give more
concrete details on working with the <a href="https://registry.opendata.aws/naip/" class="css-1diwg7s">public NAIP collection on AWS
S3</a>, a repository of cloudless aerial imagery spanning the lower 48
U.S. states at up to 60-centimeter resolution. In the following sections I&#x27;ll
give an overview of the imagery available and best practices for optimal
performance. For deployment instructions and other documentation, <a href="https://github.com/kylebarron/naip-cogeo-mosaic" class="css-1diwg7s">visit the
project on Github</a>.</p>
<h2 id="naip-data" style="position:relative" class="css-1h962gv"><a href="#naip-data" aria-label="naip data permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>NAIP Data</h2>
<p class="css-z0logh">The U.S. Department of Agriculture (USDA) oversees the <a href="https://www.fsa.usda.gov/programs-and-services/aerial-photography/imagery-programs/naip-imagery/" class="css-1diwg7s">National Agriculture
Imagery Program (NAIP)</a>. Since 2003, this program has collected
high-resolution aerial imagery of the continental U.S., with recent years
photographed at 60-centimeter resolution. This data has been free to use for a
while, but historically has been locked in cloud-unfriendly,
<a href="https://en.wikipedia.org/wiki/MrSID" class="css-1diwg7s">closed-source</a> formats.</p>
<p class="css-z0logh">However, thanks to the AWS Open Data program, NAIP imagery from 2011 to 2018 is
available on a <a href="https://registry.opendata.aws/naip/" class="css-1diwg7s">public S3 bucket</a> in <a href="https://www.cogeo.org/" class="css-1diwg7s">Cloud-Optimized GeoTIFF
(COG)</a> format. As I explained in a <a href="https://kylebarron.dev/blog/cog-mosaic/overview" class="css-1diwg7s">previous blog post</a>,
COGs democratize access to large collections of raster data by enabling fast
random-access reads.</p>
<p class="css-z0logh">Given this large collection of data freely available in a cloud-friendly format,
we can render map tiles from this imagery on demand with low latency, generally
within 500ms. This on-demand rendering provides multiple benefits:</p>
<style data-emotion="css rc057y">.css-rc057y li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-rc057y li{font-size:1rem;}}@media screen and (min-width: 768px){.css-rc057y li{font-size:1.25rem;}}</style><style data-emotion="css 15vy6y4">.css-15vy6y4 li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-15vy6y4 li{font-size:1rem;}}@media screen and (min-width: 768px){.css-15vy6y4 li{font-size:1.25rem;}}.css-15vy6y4 li{font-size:1rem;letter-spacing:-0.003em;line-height:1.625;--baseline-multiplier:0.179;--x-height-multiplier:0.35;}@media screen and (min-width: 640px){.css-15vy6y4 li{font-size:1rem;}}@media screen and (min-width: 768px){.css-15vy6y4 li{font-size:1.25rem;}}</style><ul class="css-15vy6y4">
<li class="css-zezy6m">Lower costs. By not storing a copy of the data, you can avoid storage costs for pregenerated imagery. Source NAIP data is over 30TB in size; just to store that data on S3 would cost several hundred dollars a month.</li>
<li class="css-zezy6m">Greater image selection flexibility. By not pregenerating any imagery, you can give users the choice of what year&#x27;s data to view. As soon as a new year&#x27;s data exists, your maps can be updated.</li>
</ul>
<h2 id="mosaicjson" style="position:relative" class="css-1h962gv"><a href="#mosaicjson" aria-label="mosaicjson permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>MosaicJSON</h2>
<p class="css-z0logh">As described in my <a href="https://kylebarron.dev/blog/cog-mosaic/overview#mosaicjson" class="css-1diwg7s">COG overview blog post</a>:</p>
<style data-emotion="css 1loxung">.css-1loxung{border-left-color:var(--theme-ui-colors-primary);border-left-style:solid;border-left-width:4px;margin-left:0;margin-right:0;padding-left:2rem;}.css-1loxung p{font-style:italic;}</style><style data-emotion="css m9jm23">.css-m9jm23{border-left-color:var(--theme-ui-colors-primary);border-left-style:solid;border-left-width:4px;margin-left:0;margin-right:0;padding-left:2rem;border-left-color:var(--theme-ui-colors-primary);border-left-style:solid;border-left-width:4px;margin-left:0;margin-right:0;padding-left:2rem;}.css-m9jm23 p{font-style:italic;}.css-m9jm23 p{font-style:italic;}</style><blockquote class="css-m9jm23">
<p class="css-z0logh">It&#x27;s great that all those terabytes of COG exist for public consumption, but
you still need a way to select what portions of imagery to combine. That&#x27;s
where <a href="https://github.com/developmentseed/mosaicjson-spec" class="css-1diwg7s">MosaicJSON</a> comes in. It&#x27;s a file that determines what
source files should be merged to create each web mercator map tile.</p>
</blockquote>
<p class="css-z0logh">Dynamic tiling works by combining multiple source images into a single output
image in the web mercator projection ready to send back to the client. This
process requires quickly finding the source images that are necessary to combine
for the desired tile.</p>
<p class="css-z0logh">In the NAIP case, the process of assembling a MosaicJSON is relatively simple as
the source imagery is intentionally collected in such a way as to create a
seamless mosaic per state. Images are produced in a regular grid with little
overlap between source images, all imagery is cloudless, there exists minimal
temporal variation (at least within a state), and the dataset is relatively
static (updated yearly).</p>
<p class="css-z0logh">These factors make it considerably easier to work with mosaics for NAIP imagery
than for satellite imagery, which has more overlap between scenes, large
portions of missing or cloudy data, and high temporal variation.</p>
<p class="css-z0logh">The main thing to keep in mind when creating an NAIP mosaic is to avoid
including multiple years of imagery in a single mosaic, which can slow down
dynamic tiling. Most of <code class="css-zezy6m">naip-cogeo-mosaic</code> is dedicated to working with the
NAIP metadata to create a seamless, efficient mosaic. Consult <a href="https://github.com/kylebarron/naip-cogeo-mosaic" class="css-1diwg7s">its
documentation</a> for more information.</p>
<h2 id="image-overviews" style="position:relative" class="css-1h962gv"><a href="#image-overviews" aria-label="image overviews permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Image Overviews</h2>
<p class="css-z0logh">Cloud-Optimized GeoTIFF files include a number of internal <em class="css-zezy6m">overviews</em>:
lower-resolution, downsampled versions of the image, which are precomputed and
stored with the image. Each overview level halves the height and width pixels,
so each additional level reduces the resolution by a factor of 2. These
overviews enable fast reads at a range of resolutions by minimizing the
amount of bytes that need to be read.</p>
<p class="css-z0logh">NAIP imagery in the <code class="css-zezy6m">naip-visualization</code> S3 bucket have full-resolution data
plus 5 levels of overviews. This means that NAIP data can be read most
efficiently at <em class="css-zezy6m">six</em> zoom levels, in this case zooms 12-17. At zooms higher than
17, the images look pixelated. At zooms lower than 12, many images need to be
combined and downsampled on the fly. To create an image for a single zoom 6
mercator tile, you&#x27;d need to read <em class="css-zezy6m">4,096</em> times more data at level 12, then
downsample.</p>
<p class="css-z0logh">Unsurprisingly, needing to fetch so many source images reduces performance when
rendering at lower zooms. A solution to this problem is to create <em class="css-zezy6m">pregenerated
overviews</em> for lower zooms: reading all necessary source images once then
downsampling ahead of time. Then when rendering lower zoom images, read from the
already-downsampled data.</p>
<p class="css-z0logh">In this case, to serve imagery for zooms 6-11 on the fly, I generate overview
images that are themselves Cloud-Optimized GeoTIFFs, each of which contains 5
internal overview levels. Pregenerating overviews does lose some flexibility of
COGs, as you need to choose how to combine imagery (your MosaicJSON) ahead of
time rather than on demand.</p>
<p class="css-z0logh">The <a href="https://github.com/kylebarron/naip-cogeo-mosaic" class="css-1diwg7s"><code class="css-zezy6m">naip-cogeo-mosaic</code> documentation</a> has more information
on how to use <a href="https://github.com/developmentseed/cogeo-mosaic" class="css-1diwg7s"><code class="css-zezy6m">cogeo-mosaic</code></a> to create these overviews.</p>
<h2 id="dynamic-tiling-performance" style="position:relative" class="css-1h962gv"><a href="#dynamic-tiling-performance" aria-label="dynamic tiling performance permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Dynamic Tiling Performance</h2>
<p class="css-z0logh">I&#x27;ve spent a lot of time working on performance for dynamic tiling, with the
goal of reducing latency to the point that it&#x27;s viable for a wide range of
applications.</p>
<p class="css-z0logh">With my current serverless solution hosted on AWS Lambda, I&#x27;m able to get around
500ms latency (longer for cold starts). In the following sections I&#x27;ll outline
the things you should keep in mind to keep performance as high as possible.</p>
<style data-emotion="css 11bn2j6">.css-11bn2j6{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-11bn2j6{font-size:1.5rem;}}@media screen and (min-width: 768px){.css-11bn2j6{font-size:1.5rem;}}@media screen and (min-width: 1024px){.css-11bn2j6{font-size:1.875rem;}}</style><style data-emotion="css ns8t27">.css-ns8t27{font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;margin-top:2rem;color:var(--theme-ui-colors-heading);font-family:inherit;font-weight:700;line-height:1.25;margin:0;margin-bottom:0.25rem;font-size:1.25rem;margin-top:2rem;color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-ns8t27{font-size:1.5rem;}}@media screen and (min-width: 768px){.css-ns8t27{font-size:1.5rem;}}@media screen and (min-width: 1024px){.css-ns8t27{font-size:1.875rem;}}@media screen and (min-width: 640px){.css-ns8t27{font-size:1.5rem;}}@media screen and (min-width: 768px){.css-ns8t27{font-size:1.5rem;}}@media screen and (min-width: 1024px){.css-ns8t27{font-size:1.875rem;}}</style><h3 id="minimize-number-of-source-assets" style="position:relative" class="css-ns8t27"><a href="#minimize-number-of-source-assets" aria-label="minimize number of source assets permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Minimize number of source assets</h3>
<p class="css-z0logh">Since GDAL, the program underlying the dynamic tiling process, is synchronous,
the largest amount of time is spent waiting on network requests to S3 for each
portion of the image. Thus, one of the best ways to minimize total time is to
minimize the number of images the tiler has to fetch to combine into a single
web mercator tile.</p>
<p class="css-z0logh">As <a href="#mosaicjson" class="css-1diwg7s">described above</a>, this step is done ahead of time, while
creating the MosaicJSON. The process of minimizing superfluous source assets is
taken care of within <code class="css-zezy6m">naip-cogeo-mosaic</code> when you make a mosaic.</p>
<h3 id="256x256-pixel-images" style="position:relative" class="css-ns8t27"><a href="#256x256-pixel-images" aria-label="256x256 pixel images permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>256x256 pixel images</h3>
<p class="css-z0logh">Images used in web maps usually come in square images of either 256x256 pixels
or 512x512 pixels (@2x resolution). Using @2x resolution tiles requires fewer
requests to cover the screen, since each image covers a larger area at the same
resolution, but each request takes longer. With @1x scale tiles, each tile is
1/4th the size, so you&#x27;ll need (roughly) four times the requests.</p>
<p class="css-z0logh">With this project, my goal is to push per-tile latency as low as possible.
Unsurprisingly, it takes significantly longer—my ballpark estimates are around 2
to 3 times longer—to generate a @2x scale image than a @1x scale image. Thus,
serving @1x scale images is preferable when you prioritize speed, but server
costs will be slightly higher since you need so many more requests.</p>
<h3 id="locate-server-in-us-west-2" style="position:relative" class="css-ns8t27"><a href="#locate-server-in-us-west-2" aria-label="locate server in us west 2 permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Locate server in <code class="css-zezy6m">us-west-2</code></h3>
<p class="css-z0logh">The tiler works by</p>
<ol class="css-15vy6y4">
<li class="css-zezy6m">Using the MosaicJSON to find URLs of source images that overlap the mercator tile of interest</li>
<li class="css-zezy6m">Reading the relevant portion of each source image</li>
<li class="css-zezy6m">Combining pixels into one output image ready to send back to the client</li>
</ol>
<p class="css-z0logh">While these three steps work with any file format, Cloud-Optimized GeoTIFFs
allow for huge speedups on the second part. The COG format is efficient because
it allows for intelligent streaming of portions of an image, but because a COG
is internally tiled, the tiling server will likely need several (small) GET
requests for each source image. Thus, locating the compute in the same region as
the data is absolutely essential for low total latency, as the latency for each
S3 GET request is larger across regions, and this time gets multiplied by the
number of requests per image, and the number of images needed to combine for one
mercator tile.</p>
<p class="css-z0logh">Additionally, since NAIP imagery is stored in a Requester Pays S3 bucket,
locating the server in the same region will be significantly cheaper as you
won&#x27;t need to pay egress charges on intermediate data transfer.</p>
<h3 id="use-gdal-24-not-31" style="position:relative" class="css-ns8t27"><a href="#use-gdal-24-not-31" aria-label="use gdal 24 not 31 permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Use GDAL 2.4, not 3.1</h3>
<p class="css-z0logh">As of summer 2020, GDAL 2.4 has been tested to be <a href="https://github.com/lambgeo/docker-lambda/issues/2" class="css-1diwg7s"><em class="css-zezy6m">significantly
faster</em></a> (<a href="https://github.com/developmentseed/cogeo-mosaic-tiler/issues/4#issuecomment-604120617" class="css-1diwg7s">&gt;10x</a>) than GDAL 3.1, at least for this specific
use case.</p>
<h3 id="use-dynamodb-as-the-mosaicjson-backend" style="position:relative" class="css-ns8t27"><a href="#use-dynamodb-as-the-mosaicjson-backend" aria-label="use dynamodb as the mosaicjson backend permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Use DynamoDB as the MosaicJSON backend</h3>
<p class="css-z0logh">The MosaicJSON defines a mapping from mercator tiles to image urls. Since it
must define this mapping for <em class="css-zezy6m">every mercator tile</em> (at the minimum zoom, which
for NAIP is zoom 12), the MosaicJSON file can get quite large. When saved as a
JSON file, my United States-wide mosaics are 64MB. Since this mosaic is needed
for every dynamic tiling request, storing this data in a JSON file on S3
requires the lambda function download and parse it on every request. This adds
roughly 2.5s per request for such a large mosaic.</p>
<p class="css-z0logh">Luckily, there&#x27;s an alternative to storing as JSON.
<a href="https://github.com/developmentseed/cogeo-mosaic" class="css-1diwg7s"><code class="css-zezy6m">cogeo-mosaic</code></a> supports multiple <em class="css-zezy6m">backends</em>, one of which is
<a href="https://aws.amazon.com/dynamodb/" class="css-1diwg7s">DynamoDB</a>, a serverless, low-latency key-value store. This is ideal
for storing mosaics because only one or sometimes two DynamoDB read requests are
necessary per dynamic tiling request. This lowers the time spent on the
MosaicJSON from 2.5s to around 20ms.</p>
<h3 id="client-side-image-manipulation" style="position:relative" class="css-ns8t27"><a href="#client-side-image-manipulation" aria-label="client side image manipulation permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Client-side image manipulation</h3>
<p class="css-z0logh">Often the NAIP imagery is visually a bit bland and benefits from increased
saturation. While it&#x27;s possible to do this server side, it increases image load
times by 100-200ms. For WebGL-enabled map clients like Mapbox GL JS or
<a href="https://deck.gl" class="css-1diwg7s">deck.gl</a>, client-side image saturation is easy and
instantaneous, so this is better to do client side.</p>
<h3 id="caching" style="position:relative" class="css-ns8t27"><a href="#caching" aria-label="caching permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Caching</h3>
<p class="css-z0logh">I&#x27;m a big fan of Cloudflare&#x27;s free tier as a simple solution to both speed up my
site and keep costs low by reducing the number of requests that reach my server.
Some sort of caching is ideal.</p>
<h2 id="pricing" style="position:relative" class="css-1h962gv"><a href="#pricing" aria-label="pricing permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Pricing</h2>
<p class="css-z0logh">A rough estimate of the cost with my serverless approach is <strong class="css-zezy6m">$25 per million
requests</strong>. Note that this is only for requests <em class="css-zezy6m">that reach Lambda</em>; using
Cloudflare with a long Cache-Control setting should make it effectively even
cheaper.</p>
<ul class="css-15vy6y4">
<li class="css-zezy6m">Lambda compute time: $12.5/million requests. On average, each request takes around 500 ms, when Lambda is set to 1536 MB of memory. Note that this is for @1x tiles; @2x tiles take 2-3x longer for compute (but you need fewer requests). If you have significant, stable usage, you could save by not going serverless.</li>
<li class="css-zezy6m">Lambda requests: $0.20/million.</li>
<li class="css-zezy6m">DynamoDB requests: $0.25/million. Each dynamic tiling request needs a read request to DynamoDB to find the relevant image urls.</li>
<li class="css-zezy6m">API Gateway requests: $1.00/million. I use the cheaper, newer HTTP API service instead of the older REST API service, which is $3.50/million.</li>
<li class="css-zezy6m">S3 GET requests: $8.00/million. Since NAIP imagery is stored in a requester pays bucket, the user pays for the GET requests. On average there are 4 to 6 source images, and each COG requires between 1 and 5 GET requests, depending on the zoom level and technical factors.</li>
<li class="css-zezy6m">Network egress: $2.00/million. Assuming image tiles are served as JPEGs, each image is roughly 25kb. Multiply by 4 if using @2x tiles. PNGs are significantly larger.</li>
</ul>
<p class="css-z0logh">This is a pretty good value. Once you surpass Mapbox&#x27;s (generous) free tier,
their satellite imagery costs $250/million requests. (Though that&#x27;s not a direct
apples-to-apples comparison, since you can request @2x tiles from Mapbox for
apparently the same price.) But apart from being cheap, a great benefit of the
dynamic tiling approach is that you can choose <em class="css-zezy6m">any</em> combination of imagery you
wish. It&#x27;s just as easy to serve tiles from 2011 as it is from 2018.</p>
<h2 id="drawbacks" style="position:relative" class="css-1h962gv"><a href="#drawbacks" aria-label="drawbacks permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Drawbacks</h2>
<p class="css-z0logh">That said, there are a few drawbacks to using NAIP imagery and reasons why tiled
imagery from a commercial company such as Mapbox can often be better.</p>
<ul class="css-15vy6y4">
<li class="css-zezy6m"><strong class="css-zezy6m">No global coverage</strong>: NAIP data only exists for the continental U.S. The highest-resolution public, global satellite imagery I know of is Sentinel 2 data, which has a 10-meter resolution.</li>
<li class="css-zezy6m"><strong class="css-zezy6m">Image quality</strong>: while NAIP generally has good image quality, across large areas seams are quite noticeable. NAIP is ideal when zoomed in; it can look downsampled and patchy at low zooms.</li>
<li class="css-zezy6m"><strong class="css-zezy6m">Missing areas within U.S.</strong>: some areas within the continental U.S., especially military bases, are not photographed by the NAIP program.</li>
</ul>
<p class="css-z0logh">Since this project was designed for exploration and to be &quot;good enough&quot; for
hobby mapping projects, these drawbacks are fine for my needs.</p>
<h2 id="conclusion" style="position:relative" class="css-1h962gv"><a href="#conclusion" aria-label="conclusion permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Conclusion</h2>
<p class="css-z0logh">If you appreciate this data, <strong class="css-zezy6m">talk to your elected officials</strong>. <a href="https://en.wikipedia.org/wiki/National_Agriculture_Imagery_Program" class="css-1diwg7s">According to
Wikipedia</a>, USDA is considering removing NAIP imagery from the
public domain in the near future.</p>
<h2 id="references" style="position:relative" class="css-1h962gv"><a href="#references" aria-label="references permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>References</h2>
<ul class="css-15vy6y4">
<li class="css-zezy6m"><a href="https://github.com/kylebarron/naip-cogeo-mosaic" class="css-1diwg7s"><code class="css-zezy6m">naip-cogeo-mosaic</code></a>: the open source project underlying this blog post. Refer to its documentation for how to deploy.</li>
<li class="css-zezy6m"><a href="https://developmentseed.org/titiler/" class="css-1diwg7s">Titiler</a>: a next-generation dynamic tiling server that supports both serverless and server deployment. I&#x27;d recommend this over <code class="css-zezy6m">cogeo-mosaic-tiler</code> for all new deployments.</li>
</ul>
<h2 id="acknowledgements" style="position:relative" class="css-1h962gv"><a href="#acknowledgements" aria-label="acknowledgements permalink" class="anchor before css-1diwg7s"><span><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></span></a>Acknowledgements</h2>
<p class="css-z0logh">Thanks to <a href="https://twitter.com/_VincentS_" class="css-1diwg7s">Vincent Sarago</a>, <a href="https://twitter.com/geospatialjeff" class="css-1diwg7s">Jeff Albrecht</a>, and many others for
their invaluable feedback and work pushing the Cloud-Optimized GeoTIFF ecosystem
forward.</p></section></main><style data-emotion="css y7pay1">.css-y7pay1{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-top:8rem;color:var(--theme-ui-colors-secondary);-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:var(--theme-ui-colors-divide);padding-top:1rem;}.css-y7pay1 a{color:var(--theme-ui-colors-secondary);-webkit-text-decoration:none;text-decoration:none;}.css-y7pay1 a:hover{color:var(--theme-ui-colors-heading);-webkit-text-decoration:underline;text-decoration:underline;}.css-y7pay1 a:focus{color:var(--theme-ui-colors-heading);}@media screen and (min-width: 640px){.css-y7pay1{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}@media screen and (min-width: 768px){.css-y7pay1{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><footer class="css-y7pay1"><div>© <!-- -->2024<!-- --> by <!-- -->Kyle Barron<!-- -->. All rights reserved.</div><div><a aria-label="Link to the theme&#x27;s GitHub repository" href="https://github.com/LekoArts/gatsby-themes/tree/main/themes/gatsby-theme-minimal-blog" class="css-aizfxq">Theme</a> <!-- -->by<!-- --> <a aria-label="Link to the theme author&#x27;s website" href="https://www.lekoarts.de?utm_source=minimal-blog&amp;utm_medium=Theme" class="css-aizfxq">LekoArts</a></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/cog-mosaic/naip";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-b9591c278e97ee760187.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-blog-query-tsx-2d0fa33f9f7b0ffe2721.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-homepage-query-tsx-4c274420f34ed17d215d.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-about-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-about-index-mdx-ce260f40370b9770442e.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-media-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-media-index-mdx-b26b7d553294570f15e2.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-projects-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-projects-index-mdx-1a86ff9d9773002072d3.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-resume-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx-content-file-path-content-pages-resume-index-mdx-ff708c8531492d466205.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-all-transit-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-all-transit-index-mdx-cc8e74e30c4c6b456ecd.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-caching-lambda-functions-cloudflare-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-caching-lambda-functions-cloudflare-index-mdx-e3db7af8e99f727e386a.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-cog-mosaic-naip-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-cog-mosaic-naip-index-mdx-80b50e92a5f9f44c2912.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-cog-mosaic-overview-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-cog-mosaic-overview-mdx-9605e45cf86a5c16d3f8.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-geoarrow-and-geoparquet-in-deck-gl-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-geoarrow-and-geoparquet-in-deck-gl-mdx-138682e6cb3a2875d9da.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-geoparquet-on-the-web-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-geoparquet-on-the-web-mdx-8a8d40305c39b0ebe4db.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-geos-wasm-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-geos-wasm-index-mdx-838c69635ef51fa68d07.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-launching-lonboard-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-launching-lonboard-mdx-f7518d12e8f49f018d13.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-new-website-index-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-new-website-index-mdx-9fa79a483344692a4042.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-reading-stata-files-with-python-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-reading-stata-files-with-python-mdx-301784f0fb3861b64246.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-whats-new-in-lonboard-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-whats-new-in-lonboard-mdx-c9a7071bd7c62a4704b3.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-zero-copy-apache-arrow-with-webassembly-mdx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-content-posts-zero-copy-apache-arrow-with-webassembly-mdx-f1508b732006b4936b56.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tag-query-tsx-8e9ffadb39b5b0a42e1f.js\"],\"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx\":[\"/component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-tags-query-tsx-75d2e7188bb0e9303085.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-9ea73ec6e3f203bec80f.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="e88ff8a2e75d62fe17a3";</script><script src="/webpack-runtime-92218ec8b0239bee598e.js" async></script><script src="/framework-83a512187b9c3ba5cfe7.js" async></script><script src="/app-b9591c278e97ee760187.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>